import os

from pathlib import Path

import base64

import pandas as pd

import pywhatkit as pwk
from pywhatkit.whats import open_web

from alive_progress import alive_bar

EXCEL_FILE_NAME = "WhatMessages.xlsx"
EXCEL_SHEET_NAME = "Messages"

WHAT_CONTRY_PHONE_CODE = "+595"

BASE_DIR = Path(__file__).resolve().parent

FILES_PATH= os.path.join(BASE_DIR,'images')

def create_sample(EXCEL_FILE_NAME, EXCEL_SHEET_NAME, FILES_PATH):
    df = pd.DataFrame({
        'To': ['981234567'],
        'Body': ['Mesaje de Texto de Prueba'],
        'Images': ['TEST.jpg']
    })
    writer = pd.ExcelWriter(EXCEL_FILE_NAME)
    df.to_excel(writer, sheet_name=EXCEL_SHEET_NAME, index=False)
    writer._save()
    os.mkdir(FILES_PATH)
    print(
        f'Se ha creado el archivo "{EXCEL_FILE_NAME}" complete los campos que contiene, tambien puedes pasar las imagenes a enviar en la carpeta "images"')
    image_64_decode = base64.decodebytes(b'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\nEg9Psh/6Ciw7iIQczTRWxus+oe5TTgE7Qg8LWtaFHUGYzf5Zk36Mf//aAAwDAQACAAMAAAAQ8888\n8888888888888888888888888888888888888888888888888888888888888888888888888888\n8888888888888888888888888888888888888888888888888888888888888888888888888888\n8888888888888888888888888888888888888888888888888888888888888888888888888888\n88808888848888888888888888ww88884088888888gMMMMME888sEMMMI88888s4UIo8888EMMM\nMY888U88888U8888U808o0888EE8wwU888888888o888EMQ8kM48888UsUAAc88888wwU08888ME\n84Mc88888E8A888888U8A888888A8Ec8888888c8o8888888U8A888888UsAAEU888c8YAY88888\n888o8888888U8A888888U888c88884w8s4U8888888o8888888U8A888888UoAAQU88884sQsQU8\n88888o8888888U8A888888U8A88888888sA8sc888888o8888888U8A888888U8Eww888884w0c4\n8888888o8888888U8A888888U4E8o8888kIQk4UU888888o8888888QwA888888Ywwwg8884Ew80\nwk888888wg0888888kMQ88888408884U88sMoAEs888888YMMU88888888888888888888888888\n8888888888888888888888888888888888888888888888888888888888888888888888888888\n8888888888888888888888888888888888888888888888888888888888888888888888888888\n8888888888888888888888888888888888888888888888888888888888888888888888888888\n8888888888888888888888//xAAUEQEAAAAAAAAAAAAAAAAAAACQ/9oACAEDAQE/EH2//8QAFBEB\nAAAAAAAAAAAAAAAAAAAAkP/aAAgBAgEBPxB9v//EACsQAQACAAQFAwUBAAMAAAAAAAEAESEwMVEg\n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\n3PqynX1lG0557K7SjYlGxKNiUbSof9Ev/9k=\n') 
    image_result = open(os.path.join(FILES_PATH,"TEST.jpg"), 'wb')
    image_result.write(image_64_decode)
    open_web()
    print('Sincronize el Whatsapp en su navegador predeterminado para empezar a ejecutar de vuelta "handler.py"')

try:
    df = pd.read_excel(EXCEL_FILE_NAME, sheet_name=EXCEL_SHEET_NAME)
except:
    if input(f'No existe el Archivo {EXCEL_FILE_NAME}, responda con una letra "y" si quiere crear el archivo y completarlo  : ') == 'y' or 'Y':
        create_sample(EXCEL_FILE_NAME,EXCEL_SHEET_NAME,FILES_PATH)
    exit()
        
with alive_bar(len(df)) as bar:
    for index, row in df.iterrows():
        if len(str(row['Images']))>3:
            pwk.sendwhats_image(f"{WHAT_CONTRY_PHONE_CODE}{row['To']}",f"{os.path.join(FILES_PATH,row['Images'])}" ,row['Body'],12,True)
        else:    
            pwk.sendwhatmsg_instantly(f"{WHAT_CONTRY_PHONE_CODE}{row['To']}", row['Body'],8,True)
        bar()

